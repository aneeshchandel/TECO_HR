par(mar = c(8, 8, 4, 5))
par(las = 1)
plot(obs_5cm$swc_2p5, VWC_withHR$swc.1.[obs_5cm$day], xlab = "Observed VWC (5 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_5cm$swc_2p5, VWC_withoutHR$swc.1.[obs_5cm$day], xlab = "Observed VWC (5 cm)", ylab = "", cex.lab=2, cex.axis=2, col="red")
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_15cm$swc_12p5, VWC_withHR$swc.2.[obs_15cm$day], xlab = "Observed VWC (15 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_15cm$swc_12p5, VWC_withoutHR$swc.2.[obs_15cm$day], col="red",xlab = "Observed VWC (15 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_30cm$swc_22p5, VWC_withHR$swc.3.[obs_30cm$day], xlab = "Observed VWC (30 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_30cm$swc_22p5, VWC_withoutHR$swc.3.[obs_30cm$day],  col="red",xlab = "Observed VWC (30 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_60cm$swc_37p5, VWC_withHR$swc.4.[obs_60cm$day], xlab = "Observed VWC (60 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_60cm$swc_37p5, VWC_withoutHR$swc.4.[obs_60cm$day],  col="red",xlab = "Observed VWC (60 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
##################### timeseries VWC with and without HR ######################
par(mfrow=c(2,2))
par(mar = c(8, 10, 4, 5))
par(las = 1)
plot(obs_5cm$Date, obs_5cm$swc_2p5, ylim=c(0, 0.25), xlab = "", ylab = "", cex.lab=2, cex.axis=2, main=" 5 cm")
lines(VWC_withHR$time, VWC_withHR$swc.1., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[1], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.1., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[1], 3)), pos = 4, cex=2, col="red")
# legend("bottomright", legend = c("Observed", "With HR", "Without HR"),
#        col = c("black", "blue", "red"), lty = c(NA,1,1),pch = c(1, NA, NA),
#        cex = 1.5, pt.cex=2, pt.lwd=2, x.intersp = 0.7,
#        horiz = F)
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
plot(obs_15cm$Date, obs_15cm$swc_12p5, xlab = "", ylab = "", ylim = c(0,0.25), cex.lab=2, cex.axis=2, main=" 15 cm")
lines(VWC_withHR$time, VWC_withHR$swc.2., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[2], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.2., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[2], 3)), pos = 4, cex=2, col="red")
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
plot(obs_30cm$Date, obs_30cm$swc_22p5, ylim = c(0.0, 0.25), xlab = "", ylab = "", cex.lab=2, cex.axis=2, main=" 30 cm")
lines(VWC_withHR$time, VWC_withHR$swc.3., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[3], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.3., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[3], 3)), pos = 4, cex=2, col="red")
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
plot(obs_60cm$Date, obs_60cm$swc_37p5, ylim = c(0, 0.25), xlab = "", ylab = "", cex.lab=2, cex.axis=2, main=" 60 cm")
lines(VWC_withHR$time, VWC_withHR$swc.4., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[4], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.4., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[4], 3)), pos = 4, cex=2, col="red")
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
#
# ################## daily C flux ############################
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
plot(c_flux_d_HR$date, c_flux_d_HR$NEE, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$NEE, col="red")
title(ylab=expression('NEE (g/m'^2*')'), line=6.2, cex.lab=2)
plot(c_flux_d_HR$date, c_flux_d_HR$GPP, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$GPP, col="red")
title(ylab=expression('GPP (g/m'^2*')'), line=6.2, cex.lab=2)
plot(c_flux_d_HR$date, c_flux_d_HR$Reco, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$Reco, col="red")
title(ylab=expression('Ecosystem respiration (g/m'^2*')'), line=6.2, cex.lab=2)
plot(c_flux_d_HR$date, c_flux_d_HR$FoliageC, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$FoliageC, col="red")
title(ylab=expression('Foliage (g/m'^2*')'), line=6.2, cex.lab=2)
################## yearly C flux ###############################
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
barplot(
rbind(c_flux_yr_withouttHR$NEE_yr, c_flux_yr_HR$NEE_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('NEE (g/m'^2*')'), line=6.2, cex.lab=2)
barplot(
rbind(c_flux_yr_withouttHR$GPP_yr, c_flux_yr_HR$GPP_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('GPP (g/m'^2*')'), line=6.2, cex.lab=2)
barplot(
rbind(c_flux_yr_withouttHR$NPP_yr, c_flux_yr_HR$NPP_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('NPP (g/m'^2*')'), line=6.2, cex.lab=2)
barplot(
rbind(c_flux_yr_withouttHR$Resp_eco_yr, c_flux_yr_HR$Resp_eco_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('Ecosystem respiration (g/m'^2*')'), line=6.2, cex.lab=2)
c_flux_df <- data.frame(
year = c_flux_yr_HR$yr,
NEE_withoutHR = round(c_flux_yr_withouttHR$NEE_yr, 2),
NEE_withHR = round(c_flux_yr_HR$NEE_yr, 2),
GPP_withoutHR = round(c_flux_yr_withouttHR$GPP_yr, 2),
GPP_withHR = round(c_flux_yr_HR$GPP_yr, 2),
NPP_withoutHR = round(c_flux_yr_withouttHR$NPP_yr, 2),
NPP_withHR = round(c_flux_yr_HR$NPP_yr, 2),
RECO_withoutHR = round(c_flux_yr_withouttHR$Resp_eco_yr, 2),
RECO_withHR = round(c_flux_yr_HR$Resp_eco_yr, 2)
)
simulation <- data.frame(date = VWC_withHR$time)
simulation$swc_1 <- (VWC_withHR$swc.1. - VWC_withoutHR$swc.1.)/VWC_withoutHR$swc.1.*100
simulation$swc_2 <- (VWC_withHR$swc.2. - VWC_withoutHR$swc.2.)/VWC_withoutHR$swc.2.*100
simulation$swc_3 <- (VWC_withHR$swc.3. - VWC_withoutHR$swc.3.)/VWC_withoutHR$swc.3.*100
simulation$swc_4 <- (VWC_withHR$swc.4. - VWC_withoutHR$swc.4.)/VWC_withoutHR$swc.4.*100
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
plot(simulation$date, simulation$swc_1, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 5cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(simulation$date, simulation$swc_2, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 15cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(simulation$date, simulation$swc_3, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 30cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(simulation$date, simulation$swc_4, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 60cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
c_flux_simulation <- data.frame(date=c_flux_d_HR$date)
c_flux_simulation$NEE <- (c_flux_d_HR$NEE- c_flux_d_withoutHR$NEE)#/c_flux_d_withoutHR$NEE*100
c_flux_simulation$GPP <- (c_flux_d_HR$GPP- c_flux_d_withoutHR$GPP)#/c_flux_d_withoutHR$GPP*100
c_flux_simulation$Reco <- (c_flux_d_HR$Reco- c_flux_d_withoutHR$Reco)#/c_flux_d_withoutHR$Reco*100
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
plot(c_flux_simulation$date, c_flux_simulation$NEE, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "NEE")
title(ylab=expression('Simulation difference between \n with and without NEE (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(c_flux_simulation$date, c_flux_simulation$GPP, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "GPP")
title(ylab=expression('Simulation difference between \n with and without GPP (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(c_flux_simulation$date, c_flux_simulation$Reco, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Ecosystem respiration")
title(ylab=expression('Simulation difference between \n with and without Ecosystem respiration (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/1_Output/withoutHR/Simu")
x <- read.csv("Simu_swater_flux.txt")
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/1_Output/withHR/Simu")
y <- read.csv("Simu_swater_flux.txt")
# VWC_withoutHR$vwc_average <- (VWC_withoutHR$swc.1.*5+VWC_withoutHR$swc.2.*10+VWC_withoutHR$swc.3.*15+VWC_withoutHR$swc.4.*30+VWC_withoutHR$swc.5.*20+
#   VWC_withoutHR$swc.6.*20+VWC_withoutHR$swc.1.*20+VWC_withoutHR$swc.1.*20+VWC_withoutHR$swc.1.*20+VWC_withoutHR$swc.1.*20)/(180)
# VWC_withHR$vwc_average <- (VWC_withHR$swc.1.*5+VWC_withHR$swc.2.*10+VWC_withHR$swc.3.*15+VWC_withHR$swc.4.*30+VWC_withHR$swc.5.*20+
#                                 VWC_withHR$swc.6.*20+VWC_withHR$swc.1.*20+VWC_withHR$swc.1.*20+VWC_withHR$swc.1.*20+VWC_withHR$swc.1.*20)/(180)
VWC_withoutHR$vwc_average <- (VWC_withoutHR$swc.1.*5+VWC_withoutHR$swc.2.*10+VWC_withoutHR$swc.3.*15+VWC_withoutHR$swc.4.*30)/(60)
VWC_withHR$vwc_average <- (VWC_withHR$swc.1.*5+VWC_withHR$swc.2.*10+VWC_withHR$swc.3.*15+VWC_withHR$swc.4.*30)/(60)
hydraulic_red <- as.data.frame(VWC_withoutHR$time)
hydraulic_red$HR <- (VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100
plot(VWC_withoutHR$time, (VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, cex.lab=2, cex.axis=2, ylab = "", xlab = "", type="l")
title(ylab="Difference between with \n and without HR VWC (%)", line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot((VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, c_flux_simulation$GPP)
abline(h = 0, col = "red", lty = 2)
plot((VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, c_flux_simulation$NEE)
abline(h = 0, col = "red", lty = 2)
plot((VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, c_flux_simulation$Reco)
abline(h = 0, col = "red", lty = 2)
plot(c_flux_simulation$date, c_flux_simulation$GPP, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "GPP")
title(ylab=expression('Simulation difference between \n with and without GPP (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
lines(VWC_withoutHR$time, (VWC_withHR$vwc_average-VWC_withoutHR$vwc_average))
plot(hydraulic_red$HR/max(abs(hydraulic_red$HR)), c_flux_simulation$NEE/max(abs(c_flux_simulation$NEE)))
plot(hydraulic_red$HR/max(abs(hydraulic_red$HR)), c_flux_simulation$GPP/max(abs(c_flux_simulation$GPP)))
plot(hydraulic_red$HR/max(abs(hydraulic_red$HR)), c_flux_simulation$Reco/max(abs(c_flux_simulation$Reco)))
lm_model <- lm(hydraulic_red$HR~c_flux_d_HR$Reco)
summary(lm_model)
# Extract R-squared value
# setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/Model_data/out_processed_data/Hourly dataset/Scripts")
#
# daily_met <- read.csv("daily_met.csv")
# daily_met$TIMESTAMP <- as.Date(daily_met$TIMESTAMP, format = "%d-%b-%Y")
#
# par(mar = c(5, 4, 4, 8))
# # Plot precipitation on the left y-axis
# plot(daily_met$TIMESTAMP, daily_met$ppt_final, type = "h", xlab = "Date", ylab = "Precipitation (mm)", main = "Daily Precipitation")
#
# # Add second y-axis for soil water content
# par(new = TRUE)  # Add the new plot on top of the existing one
# plot(VWC_withoutHR$time, VWC_withoutHR$swc.1., type = "l", col = "blue", xlab = "", ylab = "", main = "", axes = FALSE)
# axis(4, col = "blue", ylim = range(VWC_withoutHR$swc.1.), col.axis = "blue")  # Add the axis on the right side
# mtext("Soil Water Content", side = 4, line = 3, col = "blue", las = 2)  # Add label for the second y-axis
rm(list = ls())
library(ggplot2)
library(Metrics)
library(dplyr)
library(minpack.lm)
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/0_Data/observations/SWC")
obs_5cm <- read.csv("GLand_swc_2p5_d.csv")
obs_5cm$Date <- as.Date(obs_5cm$Date, format = "%m/%d/%Y")
obs_15cm <- read.csv("GLand_swc_12p5_d.csv")
obs_15cm$Date <- as.Date(obs_15cm$Date, format = "%m/%d/%Y")
obs_30cm <- read.csv("GLand_swc_22p5_d.csv")
obs_30cm$Date <- as.Date(obs_30cm$Date, format = "%m/%d/%Y")
obs_60cm <- read.csv("GLand_swc_37p5_d.csv")
obs_60cm$Date <- as.Date(obs_60cm$Date, format = "%m/%d/%Y")
time <- read.csv("daily_vwc.csv")
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/1_Output/withHR/Simu")
VWC_withHR <- read.csv("simu_swater_d.txt")
VWC_withHR$time <- as.Date(time$TIMESTAMP, format = "%d-%b-%Y")
stemp_withHR <- read.csv("Simu_stemp.txt")
c_flux_d_HR <- read.csv("simu_cflux_d.txt")
c_flux_d_HR$date <- VWC_withHR$time
c_flux_yr_HR <- read.csv("simu_cflux_yr.txt")
poten_withHR <- read.csv("Simu_swater_flux.txt")
poten_withHR$time <- as.Date(time$TIMESTAMP, format = "%d-%b-%Y")
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/1_Output/withoutHR/Simu")
VWC_withoutHR <- read.csv("simu_swater_d.txt")
VWC_withoutHR$time <- as.Date(time$TIMESTAMP, format = "%d-%b-%Y")
stemp_without <- read.csv("Simu_stemp.txt")
c_flux_d_withoutHR <- read.csv("simu_cflux_d.txt")
c_flux_d_withoutHR$date <- VWC_withoutHR$time
c_flux_yr_withouttHR <- read.csv("simu_cflux_yr.txt")
poten_withoutHR <- read.csv("Simu_swater_flux.txt")
poten_withoutHR$time <- as.Date(time$TIMESTAMP, format = "%d-%b-%Y")
#
# plot(poten_withHR$wpotent.2., poten_withoutHR$wpotent.2.)
# abline(0,1)
#
# plot(poten_withHR$wpotent.3., poten_withoutHR$wpotent.3.)
# abline(0,1)
#
# plot(poten_withHR$wpotent.4., poten_withoutHR$wpotent.4.)
# abline(0,1)
# plot(1:43824, poten_withoutHR$wpotent.2.)
# lines(1:43824, poten_withHR$wpotent.2.)
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/0_Data/input/drivers")
forcing <- read.csv("P2_forcing.csv")
# par(mfrow=c(2,1))
# plot(forcing$Tsoil, stemp_withHR$Tsoil0)
# abline(0,1)
# plot(forcing$Tsoil, stemp_without$Tsoil0)
# abline(0,1)
#
# plot(1:43824, forcing$Tsoil)
# plot(1:43824, stemp$Tsoil0)
rmse_result <- rmse(obs_5cm$swc_2p5, VWC_withHR$swc.1.[obs_5cm$day])
rmse_result_without <- rmse(obs_5cm$swc_2p5, VWC_withoutHR$swc.1.[obs_5cm$day])
rmse_result_15 <- rmse(obs_15cm$swc_12p5, VWC_withHR$swc.2.[obs_15cm$day])
rmse_result_without_15 <- rmse(obs_15cm$swc_12p5, VWC_withoutHR$swc.2.[obs_15cm$day])
rmse_result_30 <- rmse(obs_30cm$swc_22p5, VWC_withHR$swc.3.[obs_30cm$day])
rmse_result_without_30 <- rmse(obs_30cm$swc_22p5, VWC_withoutHR$swc.3.[obs_30cm$day])
rmse_result_60 <- rmse(obs_60cm$swc_37p5, VWC_withHR$swc.4.[obs_60cm$day])
rmse_result_without_60 <- rmse(obs_60cm$swc_37p5, VWC_withoutHR$swc.4.[obs_60cm$day])
RMSE <- data.frame(soil_depth = c(5, 15, 30, 60),
without_HR = c(rmse_result_without, rmse_result_without_15, rmse_result_without_30, rmse_result_without_60),
with_HR = c(rmse_result, rmse_result_15, rmse_result_30, rmse_result_60))
par(mfrow=c(2,2))
par(mar = c(8, 8, 4, 5))
par(las = 1)
plot(obs_5cm$swc_2p5, VWC_withHR$swc.1.[obs_5cm$day], xlab = "Observed VWC (5 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_5cm$swc_2p5, VWC_withoutHR$swc.1.[obs_5cm$day], xlab = "Observed VWC (5 cm)", ylab = "", cex.lab=2, cex.axis=2, col="red")
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_15cm$swc_12p5, VWC_withHR$swc.2.[obs_15cm$day], xlab = "Observed VWC (15 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_15cm$swc_12p5, VWC_withoutHR$swc.2.[obs_15cm$day], col="red",xlab = "Observed VWC (15 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_30cm$swc_22p5, VWC_withHR$swc.3.[obs_30cm$day], xlab = "Observed VWC (30 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_30cm$swc_22p5, VWC_withoutHR$swc.3.[obs_30cm$day],  col="red",xlab = "Observed VWC (30 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_60cm$swc_37p5, VWC_withHR$swc.4.[obs_60cm$day], xlab = "Observed VWC (60 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (with HR)", line=6.2, cex.lab=2)
abline(0,1)
plot(obs_60cm$swc_37p5, VWC_withoutHR$swc.4.[obs_60cm$day],  col="red",xlab = "Observed VWC (60 cm)", ylab = "", cex.lab=2, cex.axis=2)
title(ylab="Modeled VWC (without HR)", line=6.2, cex.lab=2)
abline(0,1)
##################### timeseries VWC with and without HR ######################
par(mfrow=c(2,2))
par(mar = c(8, 10, 4, 5))
par(las = 1)
plot(obs_5cm$Date, obs_5cm$swc_2p5, ylim=c(0, 0.25), xlab = "", ylab = "", cex.lab=2, cex.axis=2, main=" 5 cm")
lines(VWC_withHR$time, VWC_withHR$swc.1., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[1], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.1., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[1], 3)), pos = 4, cex=2, col="red")
# legend("bottomright", legend = c("Observed", "With HR", "Without HR"),
#        col = c("black", "blue", "red"), lty = c(NA,1,1),pch = c(1, NA, NA),
#        cex = 1.5, pt.cex=2, pt.lwd=2, x.intersp = 0.7,
#        horiz = F)
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
plot(obs_15cm$Date, obs_15cm$swc_12p5, xlab = "", ylab = "", ylim = c(0,0.25), cex.lab=2, cex.axis=2, main=" 15 cm")
lines(VWC_withHR$time, VWC_withHR$swc.2., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[2], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.2., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[2], 3)), pos = 4, cex=2, col="red")
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
plot(obs_30cm$Date, obs_30cm$swc_22p5, ylim = c(0.0, 0.25), xlab = "", ylab = "", cex.lab=2, cex.axis=2, main=" 30 cm")
lines(VWC_withHR$time, VWC_withHR$swc.3., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[3], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.3., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[3], 3)), pos = 4, cex=2, col="red")
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
plot(obs_60cm$Date, obs_60cm$swc_37p5, ylim = c(0, 0.25), xlab = "", ylab = "", cex.lab=2, cex.axis=2, main=" 60 cm")
lines(VWC_withHR$time, VWC_withHR$swc.4., col="blue")
text(x = min(VWC_withHR$time)+100, y = 0.24,
labels = paste("RMSE =", round(RMSE$with_HR[4], 4)), pos = 4, cex=2, col="blue")
lines(VWC_withoutHR$time, VWC_withoutHR$swc.4., col="red")
text(x = min(VWC_withHR$time)+1000, y = 0.24,
labels = paste("RMSE =", round(RMSE$without_HR[4], 3)), pos = 4, cex=2, col="red")
title(ylab="VWC (v/v)", line=6.2, cex.lab=3)
#
# ################## daily C flux ############################
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
plot(c_flux_d_HR$date, c_flux_d_HR$NEE, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$NEE, col="red")
title(ylab=expression('NEE (g/m'^2*')'), line=6.2, cex.lab=2)
plot(c_flux_d_HR$date, c_flux_d_HR$GPP, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$GPP, col="red")
title(ylab=expression('GPP (g/m'^2*')'), line=6.2, cex.lab=2)
plot(c_flux_d_HR$date, c_flux_d_HR$Reco, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$Reco, col="red")
title(ylab=expression('Ecosystem respiration (g/m'^2*')'), line=6.2, cex.lab=2)
plot(c_flux_d_HR$date, c_flux_d_HR$FoliageC, xlab = "", ylab = "", cex.lab=2, cex.axis=2, type = "l")
lines(c_flux_d_withoutHR$date, c_flux_d_withoutHR$FoliageC, col="red")
title(ylab=expression('Foliage (g/m'^2*')'), line=6.2, cex.lab=2)
################## yearly C flux ###############################
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
barplot(
rbind(c_flux_yr_withouttHR$NEE_yr, c_flux_yr_HR$NEE_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('NEE (g/m'^2*')'), line=6.2, cex.lab=2)
barplot(
rbind(c_flux_yr_withouttHR$GPP_yr, c_flux_yr_HR$GPP_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('GPP (g/m'^2*')'), line=6.2, cex.lab=2)
barplot(
rbind(c_flux_yr_withouttHR$NPP_yr, c_flux_yr_HR$NPP_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('NPP (g/m'^2*')'), line=6.2, cex.lab=2)
barplot(
rbind(c_flux_yr_withouttHR$Resp_eco_yr, c_flux_yr_HR$Resp_eco_yr),
beside = TRUE,
col = c("red", "black"),
names.arg =c_flux_yr_HR$yr,
#legend.text = c("Without HR", "With HR"),
main = "",
xlab = "",
ylab = "", cex.axis = 2.5, cex.names = 2
)
title(ylab=expression('Ecosystem respiration (g/m'^2*')'), line=6.2, cex.lab=2)
c_flux_df <- data.frame(
year = c_flux_yr_HR$yr,
NEE_withoutHR = round(c_flux_yr_withouttHR$NEE_yr, 2),
NEE_withHR = round(c_flux_yr_HR$NEE_yr, 2),
GPP_withoutHR = round(c_flux_yr_withouttHR$GPP_yr, 2),
GPP_withHR = round(c_flux_yr_HR$GPP_yr, 2),
NPP_withoutHR = round(c_flux_yr_withouttHR$NPP_yr, 2),
NPP_withHR = round(c_flux_yr_HR$NPP_yr, 2),
RECO_withoutHR = round(c_flux_yr_withouttHR$Resp_eco_yr, 2),
RECO_withHR = round(c_flux_yr_HR$Resp_eco_yr, 2)
)
simulation <- data.frame(date = VWC_withHR$time)
simulation$swc_1 <- (VWC_withHR$swc.1. - VWC_withoutHR$swc.1.)/VWC_withoutHR$swc.1.*100
simulation$swc_2 <- (VWC_withHR$swc.2. - VWC_withoutHR$swc.2.)/VWC_withoutHR$swc.2.*100
simulation$swc_3 <- (VWC_withHR$swc.3. - VWC_withoutHR$swc.3.)/VWC_withoutHR$swc.3.*100
simulation$swc_4 <- (VWC_withHR$swc.4. - VWC_withoutHR$swc.4.)/VWC_withoutHR$swc.4.*100
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
plot(simulation$date, simulation$swc_1, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 5cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(simulation$date, simulation$swc_2, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 15cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(simulation$date, simulation$swc_3, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 30cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(simulation$date, simulation$swc_4, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Soil depth 60cm")
title(ylab="VWC difference between simulation \n with HR and without HR (%)", line=5, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
c_flux_simulation <- data.frame(date=c_flux_d_HR$date)
c_flux_simulation$NEE <- (c_flux_d_HR$NEE- c_flux_d_withoutHR$NEE)#/c_flux_d_withoutHR$NEE*100
c_flux_simulation$GPP <- (c_flux_d_HR$GPP- c_flux_d_withoutHR$GPP)#/c_flux_d_withoutHR$GPP*100
c_flux_simulation$Reco <- (c_flux_d_HR$Reco- c_flux_d_withoutHR$Reco)#/c_flux_d_withoutHR$Reco*100
par(mfrow=c(2,2))
par(mar = c(8, 11, 4, 5))
par(las = 1)
plot(c_flux_simulation$date, c_flux_simulation$NEE, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "NEE")
title(ylab=expression('Simulation difference between \n with and without NEE (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(c_flux_simulation$date, c_flux_simulation$GPP, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "GPP")
title(ylab=expression('Simulation difference between \n with and without GPP (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot(c_flux_simulation$date, c_flux_simulation$Reco, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "Ecosystem respiration")
title(ylab=expression('Simulation difference between \n with and without Ecosystem respiration (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/1_Output/withoutHR/Simu")
x <- read.csv("Simu_swater_flux.txt")
setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/TECO_Dryland_HR/Teco_model_Aneesh/1_Output/withHR/Simu")
y <- read.csv("Simu_swater_flux.txt")
# VWC_withoutHR$vwc_average <- (VWC_withoutHR$swc.1.*5+VWC_withoutHR$swc.2.*10+VWC_withoutHR$swc.3.*15+VWC_withoutHR$swc.4.*30+VWC_withoutHR$swc.5.*20+
#   VWC_withoutHR$swc.6.*20+VWC_withoutHR$swc.1.*20+VWC_withoutHR$swc.1.*20+VWC_withoutHR$swc.1.*20+VWC_withoutHR$swc.1.*20)/(180)
# VWC_withHR$vwc_average <- (VWC_withHR$swc.1.*5+VWC_withHR$swc.2.*10+VWC_withHR$swc.3.*15+VWC_withHR$swc.4.*30+VWC_withHR$swc.5.*20+
#                                 VWC_withHR$swc.6.*20+VWC_withHR$swc.1.*20+VWC_withHR$swc.1.*20+VWC_withHR$swc.1.*20+VWC_withHR$swc.1.*20)/(180)
VWC_withoutHR$vwc_average <- (VWC_withoutHR$swc.1.*5+VWC_withoutHR$swc.2.*10+VWC_withoutHR$swc.3.*15+VWC_withoutHR$swc.4.*30)/(60)
VWC_withHR$vwc_average <- (VWC_withHR$swc.1.*5+VWC_withHR$swc.2.*10+VWC_withHR$swc.3.*15+VWC_withHR$swc.4.*30)/(60)
hydraulic_red <- as.data.frame(VWC_withoutHR$time)
hydraulic_red$HR <- (VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100
plot(VWC_withoutHR$time, (VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, cex.lab=2, cex.axis=2, ylab = "", xlab = "", type="l")
title(ylab="Difference between with \n and without HR VWC (%)", line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
plot((VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, c_flux_simulation$GPP)
abline(h = 0, col = "red", lty = 2)
plot((VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, c_flux_simulation$NEE)
abline(h = 0, col = "red", lty = 2)
plot((VWC_withHR$vwc_average-VWC_withoutHR$vwc_average)/VWC_withoutHR$vwc_average*100, c_flux_simulation$Reco)
abline(h = 0, col = "red", lty = 2)
plot(c_flux_simulation$date, c_flux_simulation$GPP, type="l", cex.lab=2, cex.axis=2, ylab = "", xlab = "", main = "GPP")
title(ylab=expression('Simulation difference between \n with and without GPP (g/m'^2*')'), line=6.2, cex.lab=1.5)
abline(h = 0, col = "red", lty = 2)
lines(VWC_withoutHR$time, (VWC_withHR$vwc_average-VWC_withoutHR$vwc_average))
plot(hydraulic_red$HR/max(abs(hydraulic_red$HR)), c_flux_simulation$NEE/max(abs(c_flux_simulation$NEE)))
plot(hydraulic_red$HR/max(abs(hydraulic_red$HR)), c_flux_simulation$GPP/max(abs(c_flux_simulation$GPP)))
plot(hydraulic_red$HR/max(abs(hydraulic_red$HR)), c_flux_simulation$Reco/max(abs(c_flux_simulation$Reco)))
lm_model <- lm(hydraulic_red$HR~c_flux_d_HR$Reco)
summary(lm_model)
# Extract R-squared value
# setwd("C:/Users/akc76/OneDrive - Cornell University/Desktop/HR/Model_data/out_processed_data/Hourly dataset/Scripts")
#
# daily_met <- read.csv("daily_met.csv")
# daily_met$TIMESTAMP <- as.Date(daily_met$TIMESTAMP, format = "%d-%b-%Y")
#
# par(mar = c(5, 4, 4, 8))
# # Plot precipitation on the left y-axis
# plot(daily_met$TIMESTAMP, daily_met$ppt_final, type = "h", xlab = "Date", ylab = "Precipitation (mm)", main = "Daily Precipitation")
#
# # Add second y-axis for soil water content
# par(new = TRUE)  # Add the new plot on top of the existing one
# plot(VWC_withoutHR$time, VWC_withoutHR$swc.1., type = "l", col = "blue", xlab = "", ylab = "", main = "", axes = FALSE)
# axis(4, col = "blue", ylim = range(VWC_withoutHR$swc.1.), col.axis = "blue")  # Add the axis on the right side
# mtext("Soil Water Content", side = 4, line = 3, col = "blue", las = 2)  # Add label for the second y-axis
